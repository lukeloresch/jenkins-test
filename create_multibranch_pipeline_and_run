def org = "lukeloresch"
def repo = "${REPO_NAME}"
def branchApi = new URL("https://api.github.com/repos/${org}/${repo}/branches")
def branches = new groovy.json.JsonSlurper().parse(branchApi.newReader())
def branchName = branches[0].name
//def jobName = "${project}-${branchName}".replaceAll('/','-')
def jobName = repo

multibranchPipelineJob(jobName) {
  branchSources {
    git {
      remote("https://github.com/${org}/${repo}.git")
	    credentialsId('GH_PAT')
   	    includes('v*-*')
   	    displayName(jobName)
    }
  }
  orphanedItemStrategy {
  	discardOldItems {
    	numToKeep(20)
    }
  }
  queue(jobName)
}
